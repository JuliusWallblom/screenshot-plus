[2025-12-13 20:48:45] Extracted CoordinateSpace utility for screen/image coordinate transformations
[2025-12-13 20:51:14] Extracted TextMeasurementService for consolidated text sizing logic
[2025-12-13 20:54:00] Extracted ToolbarController and SettingsPopoverContent to separate files
[2025-12-13 20:55:53] Extracted HitTestService for annotation and handle hit testing
[2025-12-13 20:57:16] Extracted AnnotationSelectionManager for selection state management
[2025-12-13 20:58:45] Created AnnotationRenderer for reusable arrow rendering calculations
[2025-12-13 21:00:05] Extracted WindowFactory for annotation window creation
[2025-12-13 23:05:37] Fixed WindowFactory to return WindowFactoryResult with toolbarController for retention
[2025-12-13 23:09:38] Created GestureHandler for drag mode determination
