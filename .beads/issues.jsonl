{"id":"greataxe-0l9","title":"Add arrow drawing tool","description":"Implement arrow annotation tool. Similar to line but with an arrowhead at the end point.","design":"Arrow annotation model: startPoint, endPoint, strokeColor, strokeWidth. Render line plus arrowhead triangle at end. Arrowhead size proportional to stroke width. Calculate arrowhead points using vector math (rotate line direction by +/-30 degrees).","acceptance_criteria":"Given arrow tool is selected, when user clicks and drags, then: 1) An arrow preview appears during drag, 2) Arrow has proper arrowhead at end point, 3) Arrowhead scales with stroke width, 4) Arrow uses current color settings","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-12T21:25:38.177023+01:00","updated_at":"2025-12-12T21:35:31.438277+01:00","closed_at":"2025-12-12T21:35:31.438277+01:00","dependencies":[{"issue_id":"greataxe-0l9","depends_on_id":"greataxe-7dn","type":"blocks","created_at":"2025-12-12T21:27:33.916364+01:00","created_by":"daemon"},{"issue_id":"greataxe-0l9","depends_on_id":"greataxe-t9u","type":"blocks","created_at":"2025-12-12T21:27:33.945368+01:00","created_by":"daemon"}]}
{"id":"greataxe-1le","title":"Extract TextMeasurementService for text annotation sizing","description":"Consolidate all text measurement and sizing calculations into a dedicated service. Currently text size calculations are scattered across DrawingCanvasView, ImageExporter, and text annotation views with duplicated logic.","design":"Create TextMeasurementService.swift with methods for measuring text size given font/string, calculating bounding rects with padding, and providing consistent text layout calculations. This becomes the single source of truth for text dimensions.","acceptance_criteria":"Given text measurement logic is duplicated, when TextMeasurementService is extracted, then: (1) A TextMeasurementService exists with measureTextSize and calculateBoundingRect methods, (2) DrawingCanvasView and ImageExporter use this service, (3) Text annotations render identically to before, (4) Unit tests verify measurement calculations","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-13T20:42:41.831824+01:00","updated_at":"2025-12-13T20:51:32.827683+01:00","closed_at":"2025-12-13T20:51:32.827683+01:00"}
{"id":"greataxe-1ry","title":"Create AnnotationRenderer protocol and implementations","description":"Annotation rendering logic is duplicated between DrawingCanvasView (for canvas display) and ImageExporter (for export). Create a unified rendering abstraction to eliminate duplication, especially for arrows.","design":"Create AnnotationRenderer protocol with render(annotation:in:context:) method. Implement CoreGraphicsAnnotationRenderer that both DrawingCanvasView and ImageExporter can use. Move arrow head calculation, curve detection, and shape drawing to shared implementation.","acceptance_criteria":"Given rendering logic is duplicated, when AnnotationRenderer is created, then: (1) AnnotationRenderer protocol exists, (2) CoreGraphicsAnnotationRenderer implements shared rendering, (3) Both DrawingCanvasView and ImageExporter use the renderer, (4) Visual output is identical to before","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-13T20:43:21.152691+01:00","updated_at":"2025-12-13T20:59:04.029811+01:00","closed_at":"2025-12-13T20:59:04.029811+01:00","dependencies":[{"issue_id":"greataxe-1ry","depends_on_id":"greataxe-b1l","type":"blocks","created_at":"2025-12-13T20:44:38.378022+01:00","created_by":"daemon"},{"issue_id":"greataxe-1ry","depends_on_id":"greataxe-1le","type":"blocks","created_at":"2025-12-13T20:44:45.205555+01:00","created_by":"daemon"}]}
{"id":"greataxe-21h","title":"Add line drawing tool","description":"Implement straight line annotation tool. User clicks to set start point and drags to set end point.","design":"Line annotation model: startPoint, endPoint, strokeColor, strokeWidth. Render with NSBezierPath line or SwiftUI Path. Hold Shift to constrain to 45-degree angles (horizontal, vertical, diagonal).","acceptance_criteria":"Given line tool is selected, when user clicks and drags, then: 1) A line preview appears during drag, 2) Line uses current color/stroke settings, 3) Released line persists on canvas, 4) Shift constrains angles","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-12T21:25:30.507406+01:00","updated_at":"2025-12-12T21:35:31.437628+01:00","closed_at":"2025-12-12T21:35:31.437628+01:00","dependencies":[{"issue_id":"greataxe-21h","depends_on_id":"greataxe-7dn","type":"blocks","created_at":"2025-12-12T21:27:33.853398+01:00","created_by":"daemon"},{"issue_id":"greataxe-21h","depends_on_id":"greataxe-t9u","type":"blocks","created_at":"2025-12-12T21:27:33.885548+01:00","created_by":"daemon"}]}
{"id":"greataxe-2rm","title":"Extract HitTestService for annotation hit testing","description":"Hit testing logic is embedded in DrawingCanvasView making it hard to test. Extract to a dedicated service that can determine which annotation or handle is under a point.","design":"Create HitTestService.swift with methods for hitTest(point:against:in:) returning optional Annotation, and hitTestHandle() returning HandlePosition. Use coordinate space for transformations. This enables unit testing of hit detection logic.","acceptance_criteria":"Given hit testing logic is in DrawingCanvasView, when HitTestService is extracted, then: (1) HitTestService exists with hitTest and hitTestHandle methods, (2) DrawingCanvasView delegates to HitTestService, (3) Annotation selection and handle detection work identically, (4) Unit tests verify hit testing behavior","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-13T20:43:04.377068+01:00","updated_at":"2025-12-13T20:56:12.395012+01:00","closed_at":"2025-12-13T20:56:12.395012+01:00","dependencies":[{"issue_id":"greataxe-2rm","depends_on_id":"greataxe-b1l","type":"blocks","created_at":"2025-12-13T20:44:38.285213+01:00","created_by":"daemon"}]}
{"id":"greataxe-4ff","title":"Add stroke width selector to toolbar","description":"Add a dropdown/popover for selecting stroke width. Shows current width and allows changing it.","design":"Dropdown button showing current line thickness (visual representation like -- or thick line). Popover with slider or preset options (1px, 2px, 4px, 8px, etc.). Bind to annotation state for current stroke width.","acceptance_criteria":"Given the toolbar is visible, when user clicks stroke width control, then: 1) A selector appears with width options, 2) Selecting a width updates the current setting, 3) New annotations use the selected width, 4) Current width is visually indicated","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-12T21:26:10.496599+01:00","updated_at":"2025-12-12T21:35:31.439356+01:00","closed_at":"2025-12-12T21:35:31.439356+01:00","dependencies":[{"issue_id":"greataxe-4ff","depends_on_id":"greataxe-t9u","type":"blocks","created_at":"2025-12-12T21:27:41.743102+01:00","created_by":"daemon"}]}
{"id":"greataxe-5gc","title":"Add error handling with Result types for file operations","description":"File operations (save, export, load) use force unwraps and silent failures. Add proper error handling with Result types and user-facing error messages.","design":"Create ExportError and FileError enums. Modify ImageExporter to return Result\u003cURL, ExportError\u003e. Add error alerts for failed operations. Log errors for debugging. Handle edge cases like full disk, permission denied.","acceptance_criteria":"Given file operations can fail silently, when error handling is added, then: (1) Export operations return Result types, (2) Users see error alerts for failures, (3) Errors are logged, (4) App doesn't crash on file operation failures","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-13T20:44:23.326159+01:00","updated_at":"2025-12-13T20:44:23.326159+01:00","dependencies":[{"issue_id":"greataxe-5gc","depends_on_id":"greataxe-ec9","type":"blocks","created_at":"2025-12-13T20:44:51.391015+01:00","created_by":"daemon"},{"issue_id":"greataxe-5gc","depends_on_id":"greataxe-1ry","type":"blocks","created_at":"2025-12-13T20:44:51.423901+01:00","created_by":"daemon"}]}
{"id":"greataxe-5z6","title":"Add rectangle drawing tool","description":"Implement rectangle annotation tool. User clicks and drags to draw rectangles with the current stroke color and width.","design":"Rectangle annotation model: origin point, size, strokeColor, strokeWidth, fillColor (optional). On mouseDown save origin, on mouseDragged update size (handle negative width/height for any drag direction), on mouseUp finalize. Render with NSBezierPath.stroke() or SwiftUI Rectangle.","acceptance_criteria":"Given rectangle tool is selected, when user clicks and drags, then: 1) A rectangle preview appears during drag, 2) Rectangle uses current color/stroke settings, 3) Released rectangle persists on canvas, 4) Dragging in any direction works correctly","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-12T21:25:16.344037+01:00","updated_at":"2025-12-12T21:35:31.436224+01:00","closed_at":"2025-12-12T21:35:31.436224+01:00","dependencies":[{"issue_id":"greataxe-5z6","depends_on_id":"greataxe-7dn","type":"blocks","created_at":"2025-12-12T21:27:33.72567+01:00","created_by":"daemon"},{"issue_id":"greataxe-5z6","depends_on_id":"greataxe-t9u","type":"blocks","created_at":"2025-12-12T21:27:33.757625+01:00","created_by":"daemon"}]}
{"id":"greataxe-6lf","title":"Display screenshot in annotation window","description":"Open a new window displaying the screenshot image when detected. The window should have a dark theme toolbar at the top and display the full screenshot below.","design":"Create a NSWindow/SwiftUI Window with: 1) Custom dark toolbar area at top, 2) NSImageView/Image displaying the screenshot, 3) Window should resize to fit image (with max bounds). Use NSPanel for floating behavior. Traffic lights (close/minimize/zoom) on left.","acceptance_criteria":"Given a screenshot file path, when the annotation window opens, then: 1) The image displays at appropriate size, 2) The window has a dark toolbar area, 3) Standard window controls work (close, minimize, zoom)","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-12T21:24:59.125416+01:00","updated_at":"2025-12-12T21:32:34.796822+01:00","closed_at":"2025-12-12T21:32:34.796822+01:00","dependencies":[{"issue_id":"greataxe-6lf","depends_on_id":"greataxe-ud9","type":"blocks","created_at":"2025-12-12T21:27:20.260058+01:00","created_by":"daemon"},{"issue_id":"greataxe-6lf","depends_on_id":"greataxe-qdu","type":"blocks","created_at":"2025-12-12T21:27:20.291183+01:00","created_by":"daemon"}]}
{"id":"greataxe-7dn","title":"Implement canvas overlay for drawing annotations","description":"Create a transparent drawing canvas layer on top of the screenshot image. This layer captures mouse events and renders annotations.","design":"Use NSView subclass or Canvas in SwiftUI overlaid on the image. Track mouse events (mouseDown, mouseDragged, mouseUp). Store annotations as model objects (type, points, color, stroke width). Render annotations in draw() method. Support hit testing for selection.","acceptance_criteria":"Given the annotation window is open, when user drags on the canvas, then: 1) Mouse events are captured, 2) Drawing coordinates are tracked, 3) The canvas can render shapes at those coordinates","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-12T21:25:06.950466+01:00","updated_at":"2025-12-12T21:34:03.033691+01:00","closed_at":"2025-12-12T21:34:03.033691+01:00","dependencies":[{"issue_id":"greataxe-7dn","depends_on_id":"greataxe-6lf","type":"blocks","created_at":"2025-12-12T21:27:25.580864+01:00","created_by":"daemon"}]}
{"id":"greataxe-7vd","title":"Add color picker to toolbar","description":"Add a color picker button showing current color with dropdown for color selection.","design":"Circular/square button filled with current color (red in reference). Click shows color picker popover with preset colors (red, orange, yellow, green, blue, purple, black, white) plus custom color option using NSColorPanel. Dropdown arrow next to button.","acceptance_criteria":"Given the toolbar is visible, when user clicks color picker, then: 1) Color options appear, 2) Selecting a color updates current setting, 3) Button shows selected color, 4) New annotations use selected color","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-12T21:26:18.526147+01:00","updated_at":"2025-12-12T21:35:31.439879+01:00","closed_at":"2025-12-12T21:35:31.439879+01:00","dependencies":[{"issue_id":"greataxe-7vd","depends_on_id":"greataxe-t9u","type":"blocks","created_at":"2025-12-12T21:27:41.773963+01:00","created_by":"daemon"}]}
{"id":"greataxe-8y4","title":"Add text annotation tool","description":"Implement text annotation tool. User clicks to place a text field, types text, and it renders on the canvas.","design":"Text annotation model: position, text string, fontSize, color. On click, show NSTextField/TextField for input at click location. On commit (Enter or click away), convert to rendered text annotation. Support basic text editing before commit.","acceptance_criteria":"Given text tool is selected, when user clicks on canvas, then: 1) A text input field appears at click location, 2) User can type text, 3) Pressing Enter or clicking away commits the text, 4) Text uses current color setting","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-12T21:25:52.599171+01:00","updated_at":"2025-12-12T21:36:20.899937+01:00","closed_at":"2025-12-12T21:36:20.899937+01:00","dependencies":[{"issue_id":"greataxe-8y4","depends_on_id":"greataxe-7dn","type":"blocks","created_at":"2025-12-12T21:27:34.037877+01:00","created_by":"daemon"},{"issue_id":"greataxe-8y4","depends_on_id":"greataxe-t9u","type":"blocks","created_at":"2025-12-12T21:27:34.074156+01:00","created_by":"daemon"}]}
{"id":"greataxe-ay6","title":"Extract ResizeRotateHandler for annotation manipulation","description":"Resize and rotate logic for annotations is complex and embedded in DrawingCanvasView. Extract to dedicated handler that manages handle positions, resize calculations, and rotation math.","design":"Create ResizeRotateHandler.swift with methods for calculating new bounds during resize, applying rotation transforms, and managing handle positions. Use CoordinateSpace for coordinate transformations. Include the handle position enum and calculation logic.","acceptance_criteria":"Given resize/rotate logic is in DrawingCanvasView, when ResizeRotateHandler is extracted, then: (1) ResizeRotateHandler exists with resize and rotate calculation methods, (2) DrawingCanvasView delegates manipulation to handler, (3) All 8 resize handles work correctly, (4) Rotation behavior unchanged, (5) Proportional resize with shift key works","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-13T20:43:39.412576+01:00","updated_at":"2025-12-13T20:43:39.412576+01:00","dependencies":[{"issue_id":"greataxe-ay6","depends_on_id":"greataxe-b1l","type":"blocks","created_at":"2025-12-13T20:44:38.348138+01:00","created_by":"daemon"},{"issue_id":"greataxe-ay6","depends_on_id":"greataxe-2rm","type":"blocks","created_at":"2025-12-13T20:44:45.235905+01:00","created_by":"daemon"}]}
{"id":"greataxe-b1l","title":"Extract CoordinateSpace utility for coordinate transformations","description":"Create a reusable CoordinateSpace struct that encapsulates screen-to-image and image-to-screen coordinate conversions. Currently this logic is duplicated across DrawingCanvasView and ImageExporter with manual calculations that are error-prone.","design":"Create a new file CoordinateSpace.swift with a struct that takes imageSize and screenRect, provides screenToImage/imageToScreen methods, and exposes scale factor. Use this consistently across the codebase to eliminate duplicate coordinate math.","acceptance_criteria":"Given coordinate mapping logic exists in DrawingCanvasView, when CoordinateSpace is extracted, then: (1) A new CoordinateSpace struct exists with screenToImage and imageToScreen methods, (2) The struct is used in DrawingCanvasView replacing inline calculations, (3) All existing annotation drawing and selection behavior works identically, (4) Unit tests verify coordinate transformations","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-13T20:42:33.478101+01:00","updated_at":"2025-12-13T20:49:14.365502+01:00","closed_at":"2025-12-13T20:49:14.365502+01:00"}
{"id":"greataxe-bsv","title":"Add freehand pen/pencil drawing tool","description":"Implement freehand drawing tool. User draws by clicking and dragging to create a freeform path.","design":"Pen annotation model: array of CGPoints, strokeColor, strokeWidth. Collect points on mouseDragged events. Use NSBezierPath with curve smoothing or SwiftUI Path. Consider point reduction algorithm for smoother lines.","acceptance_criteria":"Given pen tool is selected, when user clicks and drags, then: 1) A smooth line follows the cursor, 2) Path uses current color/stroke settings, 3) Released path persists on canvas, 4) Drawing feels responsive without lag","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-12T21:25:45.42871+01:00","updated_at":"2025-12-12T21:35:31.438839+01:00","closed_at":"2025-12-12T21:35:31.438839+01:00","dependencies":[{"issue_id":"greataxe-bsv","depends_on_id":"greataxe-7dn","type":"blocks","created_at":"2025-12-12T21:27:33.976564+01:00","created_by":"daemon"},{"issue_id":"greataxe-bsv","depends_on_id":"greataxe-t9u","type":"blocks","created_at":"2025-12-12T21:27:34.007857+01:00","created_by":"daemon"}]}
{"id":"greataxe-car","title":"Extract ToolbarDelegate to separate ToolbarController.swift file","description":"GreataxeApp.swift is 710 lines and contains ToolbarDelegate (213 lines) inline. Extract this to a dedicated file for better organization and maintainability.","design":"Create ToolbarController.swift containing the ToolbarDelegate class. Maintain all existing functionality including NSToolbarDelegate conformance, item creation, and action handling. Update GreataxeApp.swift to import and use the extracted class.","acceptance_criteria":"Given ToolbarDelegate is embedded in GreataxeApp.swift, when extracted, then: (1) ToolbarController.swift exists with the full ToolbarDelegate implementation, (2) GreataxeApp.swift imports and uses ToolbarController, (3) All toolbar functionality works identically, (4) Build succeeds with no warnings","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-13T20:42:50.358033+01:00","updated_at":"2025-12-13T20:54:20.216659+01:00","closed_at":"2025-12-13T20:54:20.216659+01:00"}
{"id":"greataxe-cvu","title":"Refactor Annotation model with protocol-based design","description":"The Annotation struct handles all annotation types with optional properties. Refactor to protocol-based design for better type safety and clearer contracts.","design":"Create AnnotationProtocol with common properties (id, bounds, rotation). Create ShapeAnnotation and TextAnnotation protocols. Implement concrete types or keep unified struct but with cleaner property access. Consider builder pattern for annotation creation.","acceptance_criteria":"Given Annotation is a single struct with optional fields, when refactored, then: (1) Annotation model has clearer type-safe property access, (2) Text-specific properties accessible only for text annotations, (3) All existing functionality preserved, (4) Serialization/undo compatibility maintained","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-13T20:44:14.471863+01:00","updated_at":"2025-12-13T20:44:14.471863+01:00"}
{"id":"greataxe-cyf","title":"Extract TextAnnotationController for text editing lifecycle","description":"Text annotation editing involves complex state management across TextAnnotationView, TextViewWrapper, and DrawingCanvasView. Extract to a dedicated controller.","design":"Create TextAnnotationController.swift that manages the text editing lifecycle: starting edit, committing text, canceling, handling focus. Coordinate with CanvasState for text annotation updates. Clean separation from gesture handling.","acceptance_criteria":"Given text editing is spread across files, when TextAnnotationController is extracted, then: (1) TextAnnotationController manages edit lifecycle, (2) Text editing works identically, (3) Enter to commit and Escape to cancel work, (4) Focus management works correctly","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-13T20:44:31.182312+01:00","updated_at":"2025-12-13T20:44:31.182312+01:00","dependencies":[{"issue_id":"greataxe-cyf","depends_on_id":"greataxe-1le","type":"blocks","created_at":"2025-12-13T20:44:45.296331+01:00","created_by":"daemon"}]}
{"id":"greataxe-dqp","title":"Add app to menu bar with status item","description":"Run app as menu bar application with status icon. Keep app running in background to monitor screenshots.","design":"Use NSStatusItem in menu bar. Hide dock icon (LSUIElement in Info.plist). Menu shows: Open last screenshot, Preferences, Quit. App stays running to monitor for screenshots. Show subtle notification when screenshot detected.","acceptance_criteria":"Given the app is launched, when user checks menu bar, then: 1) App icon appears in menu bar, 2) No dock icon is shown, 3) Menu provides basic controls, 4) App continues running when annotation window closes","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-12T21:27:01.634983+01:00","updated_at":"2025-12-12T21:39:44.555544+01:00","closed_at":"2025-12-12T21:39:44.555544+01:00","dependencies":[{"issue_id":"greataxe-dqp","depends_on_id":"greataxe-ud9","type":"blocks","created_at":"2025-12-12T21:27:41.960614+01:00","created_by":"daemon"}]}
{"id":"greataxe-dsj","title":"Implement copy to clipboard","description":"Add copy button and Cmd+C shortcut to copy the annotated screenshot to clipboard.","design":"Render current image + all annotations to a new NSImage. Use NSPasteboard.general to copy image. Button shows two overlapping rectangles icon. Flash visual feedback on copy success.","acceptance_criteria":"Given an annotated screenshot, when user clicks copy or presses Cmd+C, then: 1) Image with annotations is copied to clipboard, 2) Visual feedback confirms copy, 3) Pasting elsewhere shows the annotated image","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-12T21:26:36.017135+01:00","updated_at":"2025-12-12T21:38:21.335872+01:00","closed_at":"2025-12-12T21:38:21.335872+01:00","dependencies":[{"issue_id":"greataxe-dsj","depends_on_id":"greataxe-7dn","type":"blocks","created_at":"2025-12-12T21:27:41.83394+01:00","created_by":"daemon"}]}
{"id":"greataxe-eac","title":"Extract GestureHandler from DrawingCanvasView","description":"DrawingCanvasView (1,167 lines) handles gesture recognition, drag state, and interaction modes. Extract gesture handling to a dedicated component for better separation and testability.","design":"Create CanvasGestureHandler that processes DragGesture and hover events. It should determine the current interaction mode (drawing, selecting, resizing, rotating, moving) and dispatch to appropriate handlers. Coordinates with AnnotationSelectionManager and HitTestService.","acceptance_criteria":"Given gesture logic is in DrawingCanvasView, when GestureHandler is extracted, then: (1) CanvasGestureHandler exists managing gesture state, (2) DrawingCanvasView delegates gesture processing to handler, (3) All gesture interactions (drag, hover, click) work identically, (4) Drawing, selecting, moving, resizing, rotating all work","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-13T20:43:30.170097+01:00","updated_at":"2025-12-13T20:43:30.170097+01:00","dependencies":[{"issue_id":"greataxe-eac","depends_on_id":"greataxe-b1l","type":"blocks","created_at":"2025-12-13T20:44:38.315926+01:00","created_by":"daemon"},{"issue_id":"greataxe-eac","depends_on_id":"greataxe-2rm","type":"blocks","created_at":"2025-12-13T20:44:45.144546+01:00","created_by":"daemon"},{"issue_id":"greataxe-eac","depends_on_id":"greataxe-ec2","type":"blocks","created_at":"2025-12-13T20:44:45.176113+01:00","created_by":"daemon"}]}
{"id":"greataxe-ec2","title":"Extract AnnotationSelectionManager from DrawingCanvasView","description":"Selection state and logic (single selection, multi-selection, deselection) is mixed with gesture handling in DrawingCanvasView. Extract to dedicated manager for cleaner separation of concerns.","design":"Create AnnotationSelectionManager.swift that manages selectedAnnotations set and selectedAnnotationIDs. Provide methods for select, deselect, toggleSelection, selectAll, clearSelection. Keep selection state in this manager.","acceptance_criteria":"Given selection logic is in DrawingCanvasView, when AnnotationSelectionManager is extracted, then: (1) AnnotationSelectionManager exists with selection management methods, (2) DrawingCanvasView uses AnnotationSelectionManager for all selection operations, (3) Single and multi-selection work identically, (4) Marquee selection still works","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-13T20:43:12.532161+01:00","updated_at":"2025-12-13T20:57:34.363935+01:00","closed_at":"2025-12-13T20:57:34.363935+01:00"}
{"id":"greataxe-ec9","title":"Extract WindowFactory from AppDelegate","description":"AppDelegate manages window creation inline, making it a god object. Extract window creation and configuration to a dedicated factory.","design":"Create WindowFactory.swift with methods for creating annotation windows with proper configuration. Move NSWindow setup, delegate assignment, and WindowContext creation to factory. AppDelegate uses factory for window creation.","acceptance_criteria":"Given window creation is in AppDelegate, when WindowFactory is extracted, then: (1) WindowFactory exists with createAnnotationWindow method, (2) AppDelegate delegates to WindowFactory, (3) Windows created identically with same behavior, (4) Window resizing and toolbar work correctly","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-13T20:44:05.89897+01:00","updated_at":"2025-12-13T20:44:05.89897+01:00"}
{"id":"greataxe-egw","title":"Add oval/circle drawing tool","description":"Implement oval/circle annotation tool. User clicks and drags to draw ovals bounded by the drag rectangle.","design":"Oval annotation model: boundingRect, strokeColor, strokeWidth, fillColor (optional). Similar to rectangle but render with NSBezierPath(ovalIn:) or Ellipse in SwiftUI. Hold Shift to constrain to perfect circle.","acceptance_criteria":"Given oval tool is selected, when user clicks and drags, then: 1) An oval preview appears during drag, 2) Oval fits within the drag bounds, 3) Oval uses current color/stroke settings, 4) Released oval persists on canvas","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-12T21:25:23.349911+01:00","updated_at":"2025-12-12T21:35:31.437047+01:00","closed_at":"2025-12-12T21:35:31.437047+01:00","dependencies":[{"issue_id":"greataxe-egw","depends_on_id":"greataxe-7dn","type":"blocks","created_at":"2025-12-12T21:27:33.790145+01:00","created_by":"daemon"},{"issue_id":"greataxe-egw","depends_on_id":"greataxe-t9u","type":"blocks","created_at":"2025-12-12T21:27:33.821605+01:00","created_by":"daemon"}]}
{"id":"greataxe-iar","title":"Replace UserDefaults scattered persistence with AppSettings model","description":"CanvasState uses ~35 UserDefaults keys with hard-coded strings scattered in saveSettings/loadSettings. Replace with a structured, codable AppSettings model for type safety and maintainability.","design":"Create AppSettings.swift with @Observable class containing all settings properties. Implement Codable for JSON serialization. Persist to a single file or structured UserDefaults key. Migrate existing UserDefaults to new format on first load.","acceptance_criteria":"Given settings use scattered UserDefaults, when AppSettings is implemented, then: (1) AppSettings model contains all ~35 settings, (2) Settings persist correctly across app restarts, (3) Existing user settings migrate successfully, (4) CanvasState uses AppSettings instead of direct UserDefaults, (5) No UserDefaults string keys remain in CanvasState","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-13T20:43:49.974384+01:00","updated_at":"2025-12-13T20:43:49.974384+01:00"}
{"id":"greataxe-j2y","title":"Implement save to file","description":"Add save button to export annotated screenshot to file, replacing original or saving as new file.","design":"Render image + annotations to NSImage, then write to file using NSBitmapImageRep. Default to overwriting original screenshot file. Option for 'Save As' with NSSavePanel. Button shows disk/download icon.","acceptance_criteria":"Given an annotated screenshot, when user clicks save, then: 1) Annotated image is saved to file, 2) Original file is updated (or new file created), 3) PNG format is preserved, 4) Success feedback is shown","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-12T21:26:45.566388+01:00","updated_at":"2025-12-12T21:38:21.337023+01:00","closed_at":"2025-12-12T21:38:21.337023+01:00","dependencies":[{"issue_id":"greataxe-j2y","depends_on_id":"greataxe-7dn","type":"blocks","created_at":"2025-12-12T21:27:41.865211+01:00","created_by":"daemon"}]}
{"id":"greataxe-lk7","title":"Implement undo/redo functionality","description":"Add undo/redo buttons and keyboard shortcuts (Cmd+Z, Cmd+Shift+Z) for annotation actions.","design":"Use NSUndoManager or custom undo stack. Each annotation action (add, modify, delete) registers with undo manager. Undo button (curved arrow left), redo button (curved arrow right) in toolbar. Disable buttons when stack is empty.","acceptance_criteria":"Given annotations exist on canvas, when user clicks undo, then: 1) Last annotation action is reversed, 2) Redo becomes available, 3) Cmd+Z keyboard shortcut works, 4) Multiple undos work in sequence","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-12T21:26:27.858198+01:00","updated_at":"2025-12-12T21:37:25.410504+01:00","closed_at":"2025-12-12T21:37:25.410504+01:00","dependencies":[{"issue_id":"greataxe-lk7","depends_on_id":"greataxe-7dn","type":"blocks","created_at":"2025-12-12T21:27:41.804069+01:00","created_by":"daemon"}]}
{"id":"greataxe-nrl","title":"Implement Command pattern for undo/redo operations","description":"Current undo/redo stores full annotation snapshots without knowing what changed. Implement Command pattern for fine-grained undo that tracks specific operations.","design":"Create AnnotationCommand protocol with execute/undo methods. Implement commands for: AddAnnotationCommand, DeleteAnnotationCommand, MoveAnnotationCommand, ResizeAnnotationCommand, RotateAnnotationCommand, ChangeStyleCommand, EditTextCommand. Modify CanvasState to use command stack instead of snapshot stack.","acceptance_criteria":"Given undo uses snapshots, when Command pattern is implemented, then: (1) AnnotationCommand protocol exists, (2) Commands for all annotation operations exist, (3) Undo/redo works via command stack, (4) Undo/redo behavior identical to before, (5) Commands are more memory-efficient than full snapshots","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-13T20:43:58.079692+01:00","updated_at":"2025-12-13T20:43:58.079692+01:00","dependencies":[{"issue_id":"greataxe-nrl","depends_on_id":"greataxe-iar","type":"blocks","created_at":"2025-12-13T20:44:45.266614+01:00","created_by":"daemon"},{"issue_id":"greataxe-nrl","depends_on_id":"greataxe-cvu","type":"blocks","created_at":"2025-12-13T20:44:51.455997+01:00","created_by":"daemon"}]}
{"id":"greataxe-qdu","title":"Monitor filesystem for new screenshots","description":"Watch the macOS default screenshot location for new files. When a user takes a screenshot with Cmd+Shift+3/4/5, detect it and trigger the annotation workflow.","design":"Use FSEvents or FileManager.contentsOfDirectory with a timer to monitor ~/Desktop or the configured screenshot location. Check for files matching 'Screenshot*.png' pattern. Get screenshot location from defaults read com.apple.screencapture location. Debounce to handle rapid changes.","acceptance_criteria":"Given the app is running, when a user takes a screenshot, then: 1) The app detects the new file within 1 second, 2) The file path is captured, 3) An event/notification is triggered for the annotation window to open","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-12T21:24:49.723205+01:00","updated_at":"2025-12-12T21:31:23.592619+01:00","closed_at":"2025-12-12T21:31:23.592619+01:00","dependencies":[{"issue_id":"greataxe-qdu","depends_on_id":"greataxe-ud9","type":"blocks","created_at":"2025-12-12T21:27:15.840359+01:00","created_by":"daemon"}]}
{"id":"greataxe-s46","title":"Add crop tool","description":"Implement crop tool to trim the screenshot to a selected region.","design":"When crop tool selected, show selection handles. User drags to define crop region. Confirm button applies crop (resize image, adjust annotation positions or clip them). Cancel returns to previous state. Show crop icon in toolbar.","acceptance_criteria":"Given crop tool is selected, when user defines crop region and confirms, then: 1) Image is cropped to selection, 2) Canvas resizes to match, 3) Annotations within crop are preserved, 4) Annotations outside are clipped or removed","status":"closed","priority":3,"issue_type":"feature","created_at":"2025-12-12T21:26:53.466485+01:00","updated_at":"2025-12-12T21:40:33.655254+01:00","closed_at":"2025-12-12T21:40:33.655254+01:00","dependencies":[{"issue_id":"greataxe-s46","depends_on_id":"greataxe-7dn","type":"blocks","created_at":"2025-12-12T21:27:41.897708+01:00","created_by":"daemon"},{"issue_id":"greataxe-s46","depends_on_id":"greataxe-t9u","type":"blocks","created_at":"2025-12-12T21:27:41.929217+01:00","created_by":"daemon"}]}
{"id":"greataxe-t9u","title":"Build toolbar with tool selection buttons","description":"Create the dark toolbar at the top of the window with buttons for each drawing tool. Include visual feedback for selected tool.","design":"Horizontal stack of icon buttons in dark background (similar to screenshot). Icons: pen, rectangle (highlighted in blue when selected), oval, line, arrow, text, crop. Use SF Symbols or custom icons. Selected tool has blue background/highlight. Separator between tool groups.","acceptance_criteria":"Given the annotation window is open, when user views toolbar, then: 1) All tool buttons are visible with clear icons, 2) Current tool is highlighted, 3) Clicking a tool button selects it, 4) Toolbar has dark theme matching reference","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-12T21:26:02.326075+01:00","updated_at":"2025-12-12T21:35:18.547518+01:00","closed_at":"2025-12-12T21:35:18.547518+01:00","dependencies":[{"issue_id":"greataxe-t9u","depends_on_id":"greataxe-6lf","type":"blocks","created_at":"2025-12-12T21:27:25.54673+01:00","created_by":"daemon"}]}
{"id":"greataxe-ud9","title":"Set up Swift macOS app project structure","description":"Initialize a new macOS Swift app project with proper structure for a screenshot annotation tool. This is the foundation for all subsequent development.","design":"Create Xcode project structure manually with Package.swift for SPM, or use standard macOS app layout. Include: App delegate, main window controller, Info.plist with required permissions (screen recording for screenshots). Use SwiftUI for UI.","acceptance_criteria":"Given a fresh directory, when the project is set up, then: 1) The app compiles and runs, 2) A basic window appears, 3) The project structure supports adding annotation features","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-12T21:24:40.099295+01:00","updated_at":"2025-12-12T21:30:29.540167+01:00","closed_at":"2025-12-12T21:30:29.540167+01:00"}
{"id":"greataxe-uun","title":"Extract SettingsPopoverContent to separate SettingsView.swift file","description":"GreataxeApp.swift contains SettingsPopoverContent (310 lines) inline. This SwiftUI view handles all settings UI and should be in its own file for maintainability.","design":"Create SettingsView.swift containing SettingsPopoverContent struct. Keep all existing bindings and functionality. Update GreataxeApp.swift/ToolbarController to import the view.","acceptance_criteria":"Given SettingsPopoverContent is embedded in GreataxeApp.swift, when extracted, then: (1) SettingsView.swift exists with the full implementation, (2) Settings popover displays and functions identically, (3) All settings bindings work correctly, (4) Build succeeds","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-13T20:42:57.101468+01:00","updated_at":"2025-12-13T20:54:20.249955+01:00","closed_at":"2025-12-13T20:54:20.249955+01:00"}
{"id":"greataxe-uxo","title":"Fix: Integrate AnnotationToolbarView and DrawingCanvasView into AnnotationView","description":"AnnotationView uses placeholder AnnotationToolbar instead of AnnotationToolbarView. Also needs to integrate DrawingCanvasView for annotations.","acceptance_criteria":"AnnotationView displays the full toolbar with tools and overlays DrawingCanvasView on the image","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-12T21:42:26.4075+01:00","updated_at":"2025-12-12T21:43:24.771647+01:00","closed_at":"2025-12-12T21:43:24.771647+01:00"}
